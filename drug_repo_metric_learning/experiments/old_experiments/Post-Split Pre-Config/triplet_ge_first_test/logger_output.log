2019-07-09 17:59:48,313 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 17:59:48,314 - __main__ - INFO - 
Building Model
2019-07-09 17:59:55,634 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 17:59:55,637 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 17:59:55,637 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 17:59:55,637 - __main__ - DEBUG - Building Dataset
2019-07-09 18:00:56,912 - __main__ - DEBUG - Training
2019-07-09 18:01:02,706 - __main__ - DEBUG - res0:
2019-07-09 18:01:02,706 - __main__ - DEBUG - res1:
2019-07-09 18:01:02,706 - __main__ - DEBUG - res2:
2019-07-09 18:01:07,895 - __main__ - DEBUG - res0:
2019-07-09 18:01:07,895 - __main__ - DEBUG - res1:
2019-07-09 18:01:07,895 - __main__ - DEBUG - res2:
2019-07-09 18:01:12,636 - __main__ - DEBUG - res0:
2019-07-09 18:01:12,636 - __main__ - DEBUG - res1:
2019-07-09 18:01:12,636 - __main__ - DEBUG - res2:
2019-07-09 18:01:17,224 - __main__ - DEBUG - res0:
2019-07-09 18:01:17,225 - __main__ - DEBUG - res1:
2019-07-09 18:01:17,225 - __main__ - DEBUG - res2:
2019-07-09 18:01:21,765 - __main__ - DEBUG - res0:
2019-07-09 18:01:21,765 - __main__ - DEBUG - res1:
2019-07-09 18:01:21,765 - __main__ - DEBUG - res2:
2019-07-09 18:01:26,241 - __main__ - DEBUG - res0:
2019-07-09 18:01:26,242 - __main__ - DEBUG - res1:
2019-07-09 18:01:26,242 - __main__ - DEBUG - res2:
2019-07-09 18:02:39,401 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:02:39,402 - __main__ - INFO - 
Building Model
2019-07-09 18:02:46,701 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:02:46,701 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:02:46,701 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:02:46,701 - __main__ - DEBUG - Building Dataset
2019-07-09 18:03:48,454 - __main__ - DEBUG - Training
2019-07-09 18:03:54,300 - __main__ - DEBUG - res0:
2019-07-09 18:03:54,301 - __main__ - DEBUG - {'loss': 2.743738889694214}
2019-07-09 18:03:54,301 - __main__ - DEBUG - res1:
2019-07-09 18:03:54,301 - __main__ - DEBUG - res2:
2019-07-09 18:03:54,301 - __main__ - DEBUG - {'loss': 2.743738889694214, 'percent_correct': 53.125}
2019-07-09 18:03:59,376 - __main__ - DEBUG - res0:
2019-07-09 18:03:59,377 - __main__ - DEBUG - {'loss': 2.6549794673919678}
2019-07-09 18:03:59,377 - __main__ - DEBUG - res1:
2019-07-09 18:03:59,378 - __main__ - DEBUG - res2:
2019-07-09 18:03:59,378 - __main__ - DEBUG - {'loss': 2.6549794673919678, 'percent_correct': 53.7109375}
2019-07-09 18:04:04,221 - __main__ - DEBUG - res0:
2019-07-09 18:04:04,221 - __main__ - DEBUG - {'loss': 2.1368460655212402}
2019-07-09 18:04:04,222 - __main__ - DEBUG - res1:
2019-07-09 18:04:04,222 - __main__ - DEBUG - res2:
2019-07-09 18:04:04,222 - __main__ - DEBUG - {'loss': 2.1368460655212402, 'percent_correct': 59.1796875}
2019-07-09 18:04:08,861 - __main__ - DEBUG - res0:
2019-07-09 18:04:08,861 - __main__ - DEBUG - {'loss': 1.8782484531402588}
2019-07-09 18:04:08,861 - __main__ - DEBUG - res1:
2019-07-09 18:04:08,861 - __main__ - DEBUG - res2:
2019-07-09 18:04:08,862 - __main__ - DEBUG - {'loss': 1.8782484531402588, 'percent_correct': 52.9296875}
2019-07-09 18:04:13,433 - __main__ - DEBUG - res0:
2019-07-09 18:04:13,434 - __main__ - DEBUG - {'loss': 1.6940672397613525}
2019-07-09 18:04:13,434 - __main__ - DEBUG - res1:
2019-07-09 18:04:13,434 - __main__ - DEBUG - res2:
2019-07-09 18:04:13,434 - __main__ - DEBUG - {'loss': 1.6940672397613525, 'percent_correct': 54.296875}
2019-07-09 18:04:17,940 - __main__ - DEBUG - res0:
2019-07-09 18:04:17,940 - __main__ - DEBUG - {'loss': 1.6054633855819702}
2019-07-09 18:04:17,940 - __main__ - DEBUG - res1:
2019-07-09 18:04:17,940 - __main__ - DEBUG - res2:
2019-07-09 18:04:17,940 - __main__ - DEBUG - {'loss': 1.6054633855819702, 'percent_correct': 52.5390625}
2019-07-09 18:04:21,850 - __main__ - DEBUG - res0:
2019-07-09 18:04:21,851 - __main__ - DEBUG - {'loss': 1.4647400379180908}
2019-07-09 18:04:21,851 - __main__ - DEBUG - res1:
2019-07-09 18:04:21,851 - __main__ - DEBUG - res2:
2019-07-09 18:04:21,851 - __main__ - DEBUG - {'loss': 1.4647400379180908, 'percent_correct': 48.828125}
2019-07-09 18:04:26,198 - __main__ - DEBUG - res0:
2019-07-09 18:04:26,198 - __main__ - DEBUG - {'loss': 1.3181935548782349}
2019-07-09 18:04:26,198 - __main__ - DEBUG - res1:
2019-07-09 18:04:26,198 - __main__ - DEBUG - res2:
2019-07-09 18:04:26,198 - __main__ - DEBUG - {'loss': 1.3181935548782349, 'percent_correct': 54.6875}
2019-07-09 18:34:12,641 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:34:12,641 - __main__ - INFO - 
Building Model
2019-07-09 18:34:19,727 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:34:19,727 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:34:19,728 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:34:19,728 - __main__ - DEBUG - Building Dataset
2019-07-09 18:35:21,652 - __main__ - DEBUG - Training
2019-07-09 18:36:52,807 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:36:52,807 - __main__ - INFO - 
Building Model
2019-07-09 18:37:00,117 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:37:00,117 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:37:00,117 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:37:00,117 - __main__ - DEBUG - Building Dataset
2019-07-09 18:38:01,301 - __main__ - DEBUG - Training
2019-07-09 18:40:30,399 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:40:30,399 - __main__ - INFO - 
Building Model
2019-07-09 18:40:37,538 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:40:37,542 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:40:37,543 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:40:37,544 - __main__ - DEBUG - Building Dataset
2019-07-09 18:41:38,540 - __main__ - DEBUG - loss
2019-07-09 18:41:38,540 - __main__ - DEBUG - percent_correct
2019-07-09 18:41:39,679 - __main__ - DEBUG - Training
2019-07-09 18:42:09,639 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:42:09,639 - __main__ - INFO - 
Building Model
2019-07-09 18:42:16,961 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:42:16,964 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:42:16,964 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:42:16,964 - __main__ - DEBUG - Building Dataset
2019-07-09 18:43:17,185 - __main__ - DEBUG - loss
2019-07-09 18:43:17,185 - __main__ - DEBUG - percent_correct
2019-07-09 18:43:18,393 - __main__ - DEBUG - Training
2019-07-09 18:44:09,012 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:44:09,012 - __main__ - INFO - 
Building Model
2019-07-09 18:44:16,298 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:44:16,300 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:44:16,300 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:44:16,300 - __main__ - DEBUG - Building Dataset
2019-07-09 18:45:17,243 - __main__ - DEBUG - Training
2019-07-09 18:46:09,883 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:46:09,883 - __main__ - INFO - 
Building Model
2019-07-09 18:46:17,064 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:46:17,065 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:46:17,065 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:46:17,065 - __main__ - DEBUG - Building Dataset
2019-07-09 18:47:18,187 - __main__ - DEBUG - Training
2019-07-09 18:47:53,511 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:47:53,511 - __main__ - INFO - 
Building Model
2019-07-09 18:48:00,848 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:48:00,851 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:48:00,851 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:48:00,851 - __main__ - DEBUG - Building Dataset
2019-07-09 18:49:02,278 - __main__ - DEBUG - Training
2019-07-09 18:50:05,602 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:50:05,604 - __main__ - INFO - 
Building Model
2019-07-09 18:50:12,942 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:50:12,942 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:50:12,942 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:50:12,942 - __main__ - DEBUG - Building Dataset
2019-07-09 18:51:12,923 - __main__ - DEBUG - test
2019-07-09 18:51:12,923 - __main__ - DEBUG - test
2019-07-09 18:51:14,100 - __main__ - DEBUG - Training
2019-07-09 18:52:15,216 - __main__ - INFO - {'model_name': 'triplet_ge_first_test', 'device_num': 1, 'structure': 'triplet', 'dataset': OrderedDict([('type', 'LincsTripletDataset'), ('args', OrderedDict([('input_type', 'triplet_ge_first'), ('l1000_sigs_path', '~/DBMI_server/repo/mdeg_collab/data/lincs_level3_all_perts.pkl'), ('rank_transform', False)]))]), 'model': OrderedDict([('type', 'FeedForwardTripletNet'), ('args', OrderedDict([('input_type', 'triplet_ge_first')]))]), 'loss': OrderedDict([('type', 'TripletMarginLoss_WU'), ('online_eval_metrics', ['loss', 'percent_correct']), ('args', OrderedDict())]), 'trainer': OrderedDict([('epochs', 100), ('base_exp_dir', 'experiments/'), ('wait_before_save_models', 0)]), 'optimizer': OrderedDict([('type', 'Adam'), ('args', OrderedDict([('lr', 0.0003)]))]), 'dataset_wrapper_ge': OrderedDict([('type', 'LincsSingletGEWrapperDataset'), ('args', OrderedDict())]), 'dataset_wrapper_smiles': OrderedDict([('type', 'LincsSingletSmilesWrapperDataset'), ('args', OrderedDict())]), 'data_loader': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 512)]))]), 'data_loader_singlet': OrderedDict([('type', 'DataLoader'), ('args', OrderedDict([('batch_size', 2934)]))]), 'exp_dir': 'experiments/triplet_ge_first_test'}
2019-07-09 18:52:15,217 - __main__ - INFO - 
Building Model
2019-07-09 18:52:22,436 - __main__ - DEBUG - FeedForwardTripletNet(
  (ge_embed): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=2934, out_features=1024, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
      (3): Linear(in_features=1024, out_features=512, bias=True)
      (4): SELU()
      (5): AlphaDropout(p=0)
      (6): Linear(in_features=512, out_features=128, bias=True)
      (7): SELU()
      (8): AlphaDropout(p=0)
    )
  )
  (chemprop_encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=300, bias=False)
      (W_h): Linear(in_features=300, out_features=300, bias=False)
      (W_o): Linear(in_features=433, out_features=300, bias=True)
    )
  )
  (chem_linear): SNN_Embedder(
    (model): Sequential(
      (0): Linear(in_features=300, out_features=128, bias=True)
      (1): SELU()
      (2): AlphaDropout(p=0)
    )
  )
)
2019-07-09 18:52:22,437 - __main__ - DEBUG - TripletMarginLoss_WU(
  (distance): PairwiseDistance()
)
2019-07-09 18:52:22,437 - __main__ - DEBUG - ['loss', 'percent_correct']
2019-07-09 18:52:22,437 - __main__ - DEBUG - Building Dataset
2019-07-09 18:53:23,823 - __main__ - DEBUG - Training
